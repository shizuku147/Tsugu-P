<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>茨菇bot - 关注Afterglow喵~</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <div class="container">
        <header>
            <div class="header-content">
                <h1>🛒 每日价格追踪</h1>
                <p class="subtitle">视监系统 - 关注Afterglow喵~</p>
                <div class="header-stats">
                    <div class="stat-item">
                        <span class="stat-number" id="totalProducts">0</span>
                        <span class="stat-label">监控商品</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-number" id="updatedToday">0</span>
                        <span class="stat-label">今日更新</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-number" id="priceDrops">0</span>
                        <span class="stat-label">降价商品</span>
                    </div>
                </div>
            </div>
        </header>

        <div class="main-content">
            <!-- 添加商品区域 -->
            <div class="card main-card">
                <div class="card-header">
                    <h2>🔍 添加监控商品</h2>
                    <div class="card-actions">
                        <button class="btn-secondary" onclick="showHelp()">使用帮助</button>
                    </div>
                </div>
                <div class="card-body">
                    <div class="input-group">
                        <input type="text" id="productUrl" placeholder="粘贴淘宝、京东、天猫商品链接..." class="url-input">
                        <button class="btn-primary" onclick="addProduct()" id="addBtn">
                            <span class="btn-text">开始监控</span>
                            <span class="btn-loading" style="display: none;">添加中...</span>
                        </button>
                    </div>
                    <div class="platform-examples">
                        <p class="examples-title">支持平台：</p>
                        <div class="platform-buttons">
                            <button class="platform-btn" onclick="setExampleUrl('taobao')">
                                <span>🛍️ 淘宝</span>
                            </button>
                            <button class="platform-btn" onclick="setExampleUrl('jd')">
                                <span>🔴 京东</span>
                            </button>
                            <button class="platform-btn" onclick="setExampleUrl('tmall')">
                                <span>🐱 天猫</span>
                            </button>
                            <button class="platform-btn" onclick="setExampleUrl('pdd')">
                                <span>🎯 拼多多</span>
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 商品列表区域 -->
            <div class="card main-card">
                <div class="card-header">
                    <h2>📊 监控中的商品</h2>
                    <div class="card-actions">
                        <button class="btn-secondary" onclick="loadProducts()" id="refreshBtn">
                            <span>🔄 刷新</span>
                        </button>
                        <button class="btn-secondary" onclick="exportData()" id="exportBtn">
                            <span>📥 导出数据</span>
                        </button>
                    </div>
                </div>
                <div class="card-body">
                    <div id="productsList" class="products-grid">
                        <div class="loading-state">
                            <div class="loading-spinner"></div>
                            <p>加载商品列表中...</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 商品详情模态框 -->
        <div id="productModal" class="modal">
            <div class="modal-content large">
                <div class="modal-header">
                    <h3 id="modalTitle">商品详情</h3>
                    <span class="close" onclick="closeModal()">&times;</span>
                </div>
                <div class="modal-body">
                    <div id="modalContent">
                        <!-- 内容通过JavaScript动态加载 -->
                    </div>
                </div>
            </div>
        </div>

        <!-- 帮助模态框 -->
        <div id="helpModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>💡 使用帮助</h3>
                    <span class="close" onclick="closeHelp()">&times;</span>
                </div>
                <div class="modal-body">
                    <div class="help-content">
                        <h4>如何使用：</h4>
                        <ol>
                            <li>复制商品页面链接（淘宝、京东、天猫、拼多多等）</li>
                            <li>粘贴到上方输入框，点击"开始监控"</li>
                            <li>系统会自动获取商品信息和图片</li>
                            <li>价格每30分钟自动更新一次</li>
                        </ol>
                        
                        <h4>功能特点：</h4>
                        <ul>
                            <li>✅ 自动获取商品图片和价格</li>
                            <li>✅ 30分钟自动更新价格</li>
                            <li>✅ 价格历史图表展示</li>
                            <li>✅ 价格变化趋势分析</li>
                            <li>✅ 支持设置价格提醒</li>
                        </ul>
                        
                        <h4>温馨提示：</h4>
                        <ul>
                            <li>请确保商品链接来自支持的电商平台</li>
                            <li>系统会尊重网站的访问频率限制</li>
                            <li>价格数据仅供参考，请以实际页面为准</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <footer class="footer">
        <div class="footer-content">
            <p>每日价格追踪系统 v1.0.0 | 仅供个人学习使用</p>
            <p class="footer-links">
                <span id="serverStatus">🔴 服务器连接中...</span>
                <span id="lastUpdate">最后更新: --</span>
            </p>
        </div>
    </footer>

    <script src="{{ url_for('static', filename='app.js') }}"></script>
</body>
</html>